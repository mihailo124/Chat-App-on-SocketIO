{"ast":null,"code":"import _toConsumableArray from\"/Users/Mihail/Documents/VS/projects/chat-app/client/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"/Users/Mihail/Documents/VS/projects/chat-app/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,Fragment}from\"react\";import Info from\"../../components/Info/Info\";import Input from\"../../components/Input/Input\";import Messages from\"../../components/Messages/Messages\";import Users from\"../../components/Users/Users\";import Modal from\"../../components/UI/Modal/Modal\";import classes from\"./Chat.module.css\";import queryString from\"query-string\";import io from\"socket.io-client\";var socket;var Chat=function Chat(_ref){var location=_ref.location;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setName=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),room=_useState4[0],setRoom=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),message=_useState6[0],setMessage=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),messages=_useState8[0],setMessages=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),users=_useState10[0],setUsers=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),modalShow=_useState12[0],setModalShow=_useState12[1];var ENDPOINT=\"https://socketsio-chat.herokuapp.com/\";useEffect(function(){var _queryString$parse=queryString.parse(location.search),name=_queryString$parse.name,room=_queryString$parse.room;if(!(name||room)){alert(\"Error: empty query params!\");document.location.assign(\"/\");}setName(name);setRoom(room);socket=io(ENDPOINT);socket.emit(\"join\",{name:name,room:room},function(error){if(error){alert(error);}});return function(){socket.emit(\"disconnect\");socket.off();};},[ENDPOINT,location.search]);useEffect(function(){socket.on(\"message\",function(message){setMessages([].concat(_toConsumableArray(messages),[message]));});socket.on(\"roomData\",function(_ref2){var users=_ref2.users;return setUsers(users);});return function(){socket.emit(\"disconnect\");socket.off();};},[messages]);var sendMessage=function sendMessage(event){event.preventDefault();if(message&&!!message.replace(/\\s/g,\"\").length)socket.emit(\"sendMessage\",message,function(){return setMessage(\"\");});};var setMessageHandler=function setMessageHandler(event){return setMessage(event.target.value);};var modalToggleHandler=function modalToggleHandler(){return setModalShow(modalShow?false:true);};return React.createElement(Fragment,null,React.createElement(\"div\",{className:classes.OuterWrapper},React.createElement(\"div\",{className:classes.InnerWrapper},React.createElement(Info,{room:room,users:modalToggleHandler}),React.createElement(Messages,{messages:messages,name:name}),React.createElement(Input,{message:message,send:sendMessage,set:setMessageHandler})),React.createElement(Users,{users:users})),React.createElement(Modal,{users:users,show:modalShow,modalClosed:modalToggleHandler}));};export default Chat;","map":{"version":3,"sources":["/Users/Mihail/Documents/VS/projects/chat-app/client/src/containers/Chat/Chat.js"],"names":["React","useState","useEffect","Fragment","Info","Input","Messages","Users","Modal","classes","queryString","io","socket","Chat","location","name","setName","room","setRoom","message","setMessage","messages","setMessages","users","setUsers","modalShow","setModalShow","ENDPOINT","parse","search","alert","document","assign","emit","error","off","on","sendMessage","event","preventDefault","replace","length","setMessageHandler","target","value","modalToggleHandler","OuterWrapper","InnerWrapper"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, Fragment } from \"react\";\nimport Info from \"../../components/Info/Info\";\nimport Input from \"../../components/Input/Input\";\nimport Messages from \"../../components/Messages/Messages\";\nimport Users from \"../../components/Users/Users\";\nimport Modal from \"../../components/UI/Modal/Modal\";\n\nimport classes from \"./Chat.module.css\";\nimport queryString from \"query-string\";\nimport io from \"socket.io-client\";\n\nlet socket;\n\nconst Chat = ({ location }) => {\n  const [name, setName] = useState(\"\");\n  const [room, setRoom] = useState(\"\");\n  const [message, setMessage] = useState(\"\");\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState(\"\");\n  const [modalShow, setModalShow] = useState(false);\n\n  const ENDPOINT = \"https://socketsio-chat.herokuapp.com/\";\n\n  useEffect(() => {\n    const { name, room } = queryString.parse(location.search);\n\n    if (!(name || room)) {\n      alert(\"Error: empty query params!\");\n      document.location.assign(\"/\");\n    }\n    setName(name);\n    setRoom(room);\n\n    socket = io(ENDPOINT);\n    socket.emit(\"join\", { name, room }, error => {\n      if (error) {\n        alert(error);\n      }\n    });\n\n    return () => {\n      socket.emit(\"disconnect\");\n      socket.off();\n    };\n  }, [ENDPOINT, location.search]);\n\n  useEffect(() => {\n    socket.on(\"message\", message => {\n      setMessages([...messages, message]);\n    });\n\n    socket.on(\"roomData\", ({ users }) => setUsers(users));\n\n    return () => {\n      socket.emit(\"disconnect\");\n      socket.off();\n    };\n  }, [messages]);\n\n  const sendMessage = event => {\n    event.preventDefault();\n    if (message && !!message.replace(/\\s/g, \"\").length)\n      socket.emit(\"sendMessage\", message, () => setMessage(\"\"));\n  };\n\n  const setMessageHandler = event => setMessage(event.target.value);\n\n  const modalToggleHandler = () => setModalShow(modalShow ? false : true);\n\n  return (\n    <Fragment>\n      <div className={classes.OuterWrapper}>\n        <div className={classes.InnerWrapper}>\n          <Info room={room} users={modalToggleHandler} />\n          <Messages messages={messages} name={name} />\n          <Input message={message} send={sendMessage} set={setMessageHandler} />\n        </div>\n        <Users users={users} />\n      </div>\n      <Modal users={users} show={modalShow} modalClosed={modalToggleHandler} />\n    </Fragment>\n  );\n};\n\nexport default Chat;\n"]},"metadata":{},"sourceType":"module"}